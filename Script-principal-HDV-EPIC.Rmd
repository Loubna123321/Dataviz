---
title: "Untitled"
author: "ZIDAN Loubna"
date: "2022-11-19"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

##1. Population religieuse 

#Ici nous allons briévement représenter la population religieuse en France en 2003 (HDV) et en 2013 (EPIC) avec 2 questions. 

#1- Nous allons pouvoir faire un comparatif de 10 ans vis à vis de la population religieuse. 
#2- Nous ferons également un comparatif entre homme et femmes, religieux.ses entre 2003 et 2013, puis dans son ensemble.

```{r, echo=False}
library(foreign)
library(questionr)
library(survey)
library(R2HTML)
library(tidyverse)
library(esquisse)
library(labelled)
library(DataExplorer)
library(funModeling)
library(missForest)
library(dplyr)
library(tinytex)
```

#Exploration et nettoyage de la base HDV2003: 

##La base de donnees HDV était en 4 parties, 
##nous avons ouvert la premiere et la quatrieme...

```{r, echo=False}
hdv1<-read.dbf("hdv1.dbf")
hdv4<-read.dbf("hdv4.dbf")
```

##...pour récuperer les variables qui nous interressent.

```{r, echo=False}
hdv <- cbind(select(hdv1, c(AGEE,AGECJ)), select(hdv4, c(STATUTE,STATUTCJ,NIVE2TE,NIVE2TCJ,QUALIFE,QUALCJ,SEXEE,SEXECJ,VRELIG,VENREL,VIECOUE)))
```

## Puis nous nettoyons notre environnement

```{r, echo=False}
rm(hdv1,hdv4)
```

#appeler la script Recodage contenant les traitements des variables de la base hdv:

```{r, echo=False}
source("recodage_hdv2003.R")
```

#representer les données: 

```{r}
head(hdv)
```

#les dimensions de la base hdv:

```{r}
dim(hdv)
describe(hdv)
str(hdv)
```

#appeler le script exploration de données :

```{r, echo=False}
source("exploration_hdv2003.R")
```

## Pour la base EPIC, nous avons ouvert la base de donnees EPIC pour y recuperer ce qu'il nous faut :

```{r, echo=False}
epic <- select(read.csv("repondant.txt", sep="\t"),
               c(IndCOU,R_IMPREL,R_RELIGC,R_RELIGION,C_DIPLOMEC,M_DIPLOME,C_STATUTC,M_STATUT,SEXER,H_SEXEC_C,AGEM,H_ANAISC_C,R_MOINDIPL,R_PLUDIPL))
```

#appeler la script Recodage contenant les traitements des variables de la base epic:

```{r, echo=False}
source("recodage_epic.R")
```

#Representer les données :

```{r}
head(epic)
```

#Les dimensions de la base: 

```{r}
dim(epic)
str(epic)
```

#appeler le script exploration de données :

```{r}
source("exploration_epic.R")

```

#Comparaison :

#Nous allons pouvoir faire un comparatif de 10 ans vis à vis de la population religieuse en fonction de l'age. 

```{r}
library(ggplot2)

ggplot(hdv) +
 aes(x = "", y = Age_enquete, fill = Rapport_religion) +
 geom_boxplot() +
 scale_fill_hue(direction = 1) +
 theme_minimal()
```

#on constate que les pratiquants régulieres ont l'age autour de 60 ans, alors que les gens ni pratiquants ni appartants ont l'age autour de 40 ans

```{r}

library(ggplot2)

ggplot(epic) +
 aes(x = "", y = Age_individu, fill = Importance_religion_enquete) +
 geom_boxplot() +
 scale_fill_hue(direction = 1) +
 theme_minimal()
```

#les ages pour les 4 premieres modalités est presque le meme, il est autour de 48 ans! 

#Nous ferons  un comparatif entre homme et femmes, religieux.ses entre 2003 et 2013:


```{r}

library(ggplot2)

ggplot(hdv) +
 aes(x = Rapport_religion, fill = Sexe_enquete) +
 geom_bar() +
 scale_fill_hue(direction = 1) +
 theme_minimal()

```
#pour les pratiquants régulieres et ocasionneles , les hommes sont plus frequents que les femmes, alors que dans les autres modalités 
#ils sont egaux!


```{r}
library(ggplot2)

ggplot(epic) +
 aes(x = Importance_religion_enquete, fill = Sexe_enquete) +
 geom_bar() +
 scale_fill_hue(direction = 1) +
 theme_minimal()

```

#pour les gens qui ont déclaré que la réligion est important, assez important, et peu important les hommes sont les plus representés, alors que pour les autres modalités, ils sont égaux! 


#En suite on souhaite savoir si les individus qui ont declaré que la réligion est trop important peuvent accepter d'etre avec quelqu'un qui est moins diplomé ou plus diplomé : 
```{r}

ggplot(epic) +
  aes(x = Importance_religion_enquete, fill = Accepter_etre_avec_moins_diplome) +
  geom_bar(position = "dodge") +
  scale_fill_manual(values = c(`oui, c'est justement mon cas` = "#0FDB3F", oui = "#246D1E", non = "#AC2927", 
                               `Ne sait pas` = "#252506")) +
  theme_minimal()
```
#Selon ce graphique, on vois bien que les gens répoondant oui à cette question sont la categorie la plus representé parmi les autres
#En plus, ceux appartenants à la modalité (peu important) sont les plus à déclarer oui (accepter d'etre avec qqn moins diplomé)!
#parmi ceux qui ont répondu non, sont le plus nombreux dans la modalité (important ou assez important)

```{r}
ggplot(epic) +
  aes(x = Importance_religion_enquete, fill = Accepter_etre_avec_plus_diplome) +
  geom_bar(position = "dodge") +
  scale_fill_manual(values = c(`oui, c'est justement mon cas` = "#0FDB3F", oui = "#246D1E", non = "#AC2927", 
                               `Ne sait pas` = "#252506")) +
  theme_minimal()
```


#Selon ce graphique, on vois bien que les gens répoondant oui à cette question sont la categorie la plus representé parmi les autres
#En plus, ceux appartenants à la modalité (peu important) sont les plus à déclarer oui (accepter d'etre avec qqn plus diplomé)!
#parmi ceux qui ont répondu non, sont le plus nombreux dans la modalité (important ou assez important)


